---
title: "Interleaving two IEnumerable sources"
date: 2010-10-05T09:53:23Z
tags:
  - .NET
  - C#
  - LINQ
category: devel
layout: post
---
I was recently doing some work related to custom reporting and I needed to simply interleave two streams of data (it was actually same source, but different items selected). Kind of select first item from the first stream, first from the other, second from first, second from other etc. No big deal. 

To make this easily doable I created simple extension method for me.

<pre class="brush:csharp">
internal static IEnumerable&lt;T&gt; Interleave&lt;T&gt;(this IEnumerable&lt;T&gt; first, IEnumerable&lt;T&gt; second)
{
	using (IEnumerator&lt;T&gt;
		enumerator1 = first.GetEnumerator(),
		enumerator2 = second.GetEnumerator())
	{
		while (enumerator1.MoveNext())
		{
			yield return enumerator1.Current;
			if (enumerator2.MoveNext())
				yield return enumerator2.Current;
		}
	}
}
</pre>

It keeps reading elements from the first stream and if there's enough in the second stream then interleave. If the second one isn't "long" enough, it'll keep returning only items from first one. If the second one is "longer", it'll stop when the first one is empty. If you need handle these cases differently, you can either change the method or preprocess the streams before using this method.
