---
title: "Creating your own settings provider - example"
date: 2006-06-17T18:35:00Z
tags:
  - .NET
  - Applications in general
category: devel
layout: post
---
<p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">Sometimes you'll need to create settings provider, which allows you to save configuration into specific format and/or specific place. In FW are some basic providers, but creating your own isn't difficult.< ?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">This example shows (easy) way how to build simple provider, which save data into the specified file in xml. <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">Note: Our provider will save only user scope settings (the default behavior of standard providers) but it&#8217;s not necessary.<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">So, create new class and implement abstract class </span><span style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'">SettingsProvider</span><span lang=EN-US style="mso-ansi-language: EN-US">. The first method we'll care about is </span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: blue">void</span> Initialize(<span style="COLOR: blue">string</span> name, <span style="COLOR: teal">NameValueCollection</span> config)</span><span lang=EN-US style="mso-ansi-language: EN-US">.<span style="mso-spacerun: yes">  </span>For this method we&#8217;ll provide only calling the parent.<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: blue">void</span> Initialize(<span style="COLOR: blue">string</span> name, <span style="COLOR: teal">NameValueCollection</span> config)<span style="mso-spacerun: yes">   </span><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">base</span>.Initialize(<span style="COLOR: blue">this</span>.ApplicationName, config);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">}</span><span lang=EN-US style="mso-ansi-language: EN-US"><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /><o :p></o></span></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">Next method/property is </span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: blue">string</span> ApplicationName</span><span lang=EN-US style="mso-ansi-language: EN-US">. With it you can handle (as you probably feel) application name. We'll provide very simple implementation. <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: blue">string</span> ApplicationName<o :p></o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">get</span> { <span style="COLOR: blue">return</span> <span style="COLOR: teal">Application</span>.ProductName; }<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">set</span> { }<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /><o :p></o></span></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">Next method is </span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: teal">SettingsPropertyValueCollection</span> GetPropertyValues(<span style="COLOR: teal">SettingsContext</span> context, <span style="COLOR: teal">SettingsPropertyCollection</span> collection)</span><span lang=EN-US style="mso-ansi-language: EN-US">. This method is called when &#8220;reading the configuration&#8221;. So here we have to implement reading file (or any other storage) and filling the </span><span style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'">SettingsPropertyValueCollection</span><span lang=EN-US style="mso-ansi-language: EN-US"> collection. The first step is preparing the structure:<br /><hr /></span><span style="FONT-SIZE: 10pt; COLOR: teal; FONT-FAMILY: 'Courier New'">SettingsPropertyValueCollection</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> values = <span style="COLOR: blue">new</span> <span style="COLOR: teal">SettingsPropertyValueCollection</span>();<o :p></o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">foreach</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> (<span style="COLOR: teal">SettingsProperty</span> property <span style="COLOR: blue">in</span> collection)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: teal">SettingsPropertyValue</span> value = <span style="COLOR: blue">new</span> <span style="COLOR: teal">SettingsPropertyValue</span>(property);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>value.IsDirty = <span style="COLOR: blue">false</span>;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>values.Add(value);<br />}</span><span lang=EN-US style="mso-ansi-language: EN-US"> <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /><o :p></o></span></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">Then we&#8217;ll check whether or not the (method for getting path will be discussed later) file exists:<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">if</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> (!<span style="COLOR: teal">File</span>.Exists(<span style="COLOR: blue">this</span>.GetSavingPath))</span><span lang=EN-US style="mso-ansi-language: EN-US"><o :p></o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">return</span> values;</span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><hr id=null/><br /></span><span lang=EN-US style="mso-ansi-language: EN-US">And next we try to read our XML file with configuration and after returning result:</span> <span lang=EN-US style="mso-ansi-language: EN-US"><hr id=null/></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">using</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> (<span style="COLOR: teal">XmlTextReader</span> tr = <span style="COLOR: blue">new</span> <span style="COLOR: teal">XmlTextReader</span>(<span style="COLOR: blue">this</span>.GetSavingPath))</span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">try<o :p></o></span></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>tr.ReadStartElement(<span style="COLOR: maroon">"ID3renamer"</span>);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">foreach</span> (<span style="COLOR: teal">SettingsPropertyValue</span> value <span style="COLOR: blue">in</span> values)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">            </span><span style="COLOR: blue">if</span> (IsUserScoped(value.Property))<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">            </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                </span><span style="COLOR: blue">try<o :p></o></span></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="mso-spacerun: yes">            </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                    </span>tr.ReadStartElement(value.Name);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                    </span>value.SerializedValue = tr.ReadContentAsObject();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                    </span>tr.ReadEndElement();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                </span><span style="COLOR: blue">catch</span> (<span style="COLOR: teal">XmlException</span>)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">                </span>{ <span style="COLOR: green">/* ugly */</span> }<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">            </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>tr.ReadEndElement();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-space
run: yes">    </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">catch</span> (<span style="COLOR: teal">XmlException</span>)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>{ <span style="COLOR: green">/* ugly */</span> }<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">return</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> values;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /><o :p></o></span></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US">OK, the method for &#8222;reading&#8220; is done. Continuing with &#8222;saving&#8220;. The method is </span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">public</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">override</span> <span style="COLOR: blue">void</span> SetPropertyValues(<span style="COLOR: teal">SettingsContext</span> context, <span style="COLOR: teal">SettingsPropertyValueCollection</span> collection)</span><span lang=EN-US style="mso-ansi-language: EN-US"> and it&#8217;s very similar to reading (in fact does the same in &#8220;reverse&#8221; order).<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">using</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> (<span style="COLOR: teal">XmlTextWriter</span> tw = <span style="COLOR: blue">new</span> <span style="COLOR: teal">XmlTextWriter</span>(<span style="COLOR: blue">this</span>.GetSavingPath, <span style="COLOR: teal">Encoding</span>.Unicode))<o :p></o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>tw.WriteStartDocument();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>tw.WriteStartElement(<span style="COLOR: maroon">"ID3renamer"</span>);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">foreach</span> (<span style="COLOR: teal">SettingsPropertyValue</span> propertyValue <span style="COLOR: blue">in</span> collection)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">if</span> (IsUserScoped(propertyValue.Property))<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">            </span>tw.WriteStartElement(propertyValue.Name);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">   </span><span style="mso-spacerun: yes">         </span>tw.WriteValue(propertyValue.SerializedValue);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">            </span>tw.WriteEndElement();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>tw.WriteEndElement();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>tw.WriteEndDocument();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><o :p> </o> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none">And that&#8217;s it. This is very simple sample provider. You can build your own for your specific needs without problem.</p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><o :p> </o></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none">I&#8217;m using some helper methods. I hope there&#8217;s no need to comment it, so I&#8217;ll provide it &#8222;as-is&#8220;.</p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'; mso-no-proof: yes">private</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><font color=#000000> </font><span style="COLOR: blue">bool</span><font color=#000000> IsUserScoped(</font><span style="COLOR: teal">SettingsProperty</span><font color=#000000> property)<o :p></o></font></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><font color=#000000>{<o :p></o></font></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes"><font color=#000000>    </font></span><span style="COLOR: blue">return</span><font color=#000000> property.Attributes.ContainsKey(</font><span style="COLOR: blue">typeof</span><font color=#000000>(</font><span style="COLOR: teal">UserScopedSettingAttribute</span><font color=#000000>));<o :p></o></font></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><font color=#000000>}</font></span></p></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">private</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"> <span style="COLOR: blue">string</span> GetSavingPath<o :p></o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">get<o :p></o></span></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">return</span> <span style="COLOR: teal">Environment</span>.GetFolderPath(<span style="COLOR: teal">Environment</span>.<span style="COLOR: teal">SpecialFolder</span>.ApplicationData) + <span style="COLOR: teal">Path</span>.DirectorySeparatorChar + <span style="COLOR: maroon">"ID3 renamer"</span> + <span style="COLOR: teal">Path</span>.DirectorySeparatorChar + <span style="COLOR: maroon">"user.config"</span>;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">    </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'">}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><span lang=EN-US style="mso-ansi-language: EN-US"><hr /></span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'"><o :p> </o></span> </p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-pagination: none; mso-layout-grid-align: none"><em>Note: This is part of my own provider (to understand some 'ID3 renamer' strings) used in my <a href="http://www.id3renamer.com/">ID3 renamer</a> application (which is now in &#8222;to .NET rewriting&#8220; phase).</em> :-)</p>
