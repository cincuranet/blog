---
title: "NBackup support in FirebirdClient"
date: 2013-09-05T14:56:37Z
tags:
  - .NET
  - Firebird
category: devel
layout: post
---
Today I had a little of spare time and I had in my head support for <a href="http://tracker.firebirdsql.org/browse/DNET-224">NBackup via Services API</a> in <a href="http://www.firebirdsql.org/en/net-provider/">FirebirdClient</a> for a long time. Especially since <a href="{% post_url 2013-05-27-233284-windows-azure-web-sites-and-firebird %}">NBackup saved me on Azure Websites</a>.I was guessing it should not take that long to implement it, if you're in a good mood. Surprisingly I was right with my estimate.

So let me introduce to you two new classes you will be able to use in next version. It's <code>FbNBackup</code> and <code>FbNRestore</code> (I'm still validating the naming in my head). You have all the switches and option from command line available ("no database triggers", "direct IO", ...).

To create a level 0 backup you can just call:

<pre class="brush:csharp">
var nbak = new FbNBackup();
nbak.ConnectionString = "..."
nbak.Level = 0;
nbak.BackupFile = "database.fnbk0"
nbak.DirectIO = true;
nbak.Options = FbNBackupFlags.NoDatabaseTriggers;
nbak.Execute();
</pre>

Changing to <code>nbak.Level = 1;</code> you'll create another level and so on.

Restoring is even simpler. You just need your chain of backups and call:

<pre class="brush:csharp">
var nrest = new FbNRestore();
nrest.ConnectionString = "..."
nrest.BackupFiles = new[] { "database.fnbk0", "database.fnbk1" };
nrest.DirectIO = true;
nrest.Execute();
</pre>

It's pretty much same API as with regular <code>FbBackup</code> and <code>FbRestore</code>, just with incremental-ish backup flavor. What else you'd like to see in foreseeable future in FirebirdClient?
