---
title: "Asociace programu na pravé tlačítko pro složku"
date: 2006-02-12T14:56:00Z
tags:
  - .NET
redirect_from: /id/7398/
category: none
layout: post
---
<p>Potřeboval jsem, abych si mohl svůj progámek spustit lehce přes kontextové menu vyvolané na složce. Ve starých zdrojácích v Delphi jsem našel funkci, která sloužila před lety. Pak jsem ji jen přepsal do C#. Kdo má zájem, může využít procedurku níže. Je úplně jednoduchá, kdo chce víc, nechť se podívá do registrů jak do dělají jiné programy. ;-)</p>

<pre class="brush:csharp">
public static void AssociateForFolder(string menuName, string exeName)
{
	RegistryKey rk = Registry.ClassesRoot.OpenSubKey(@"Directoryshell", true);
	rk.CreateSubKey(menuName).CreateSubKey("command").SetValue("", """ + exeName + "" "%1"");
}
</pre>

<p>Pozn.: V ostrém nasazení <i>doporučuju</i> ošetřit vyjímky. :-)</p>