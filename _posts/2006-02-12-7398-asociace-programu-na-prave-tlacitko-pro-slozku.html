---
title: "Asociace programu na pravé tlačítko pro složku"
date: 2006-02-12T14:56:00Z
tags:
  - .NET
category: none
layout: post
---
<p>Potřeboval jsem, abych si mohl svůj prog&#225;mek spustit lehce přes kontextov&#233; menu vyvolan&#233; na složce. Ve star&#253;ch zdroj&#225;c&#237;ch v Delphi jsem na&#353;el funkci, kter&#225; sloužila před lety. Pak jsem ji jen přepsal do C#. Kdo m&#225; z&#225;jem, může využ&#237;t procedurku n&#237;že. Je &#250;plně jednoduch&#225;, kdo chce v&#237;c, nechť se pod&#237;v&#225; do registrů jak do dělaj&#237; jin&#233; programy. ;-)</p><p><hr id=null/></p><p></p><font size=2></font><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">public</span> <span style="COLOR: blue">static</span> <span style="COLOR: blue">void</span> AssociateForFolder(<span style="COLOR: blue">string</span> menuName, <span style="COLOR: blue">string</span> exeName)< ?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes">        </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes">            </span><span style="COLOR: teal">RegistryKey</span> rk = <span style="COLOR: teal">Registry</span>.ClassesRoot.OpenSubKey(<span style="COLOR: maroon">@"Directoryshell"</span>, <span style="COLOR: blue">true</span>);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes">            </span>rk.CreateSubKey(menuName).CreateSubKey(<span style="COLOR: maroon">"command"</span>).SetValue(<span style="COLOR: maroon">""</span>, <span style="COLOR: maroon">"""</span> + exeName + <span style="COLOR: maroon">"" "%1""</span>);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><span style="mso-spacerun: yes">        </span>}</span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes"><hr id=null/></span></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><font face="Times New Roman" size=3>Pozn.: V ostr&#233;m nasazen&#237; <em>doporučuju</em> o&#353;etřit vyj&#237;mky. :-)</font></p>
