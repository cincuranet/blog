---
title: "\"Local\" Queries 2nd edition"
date: 2009-02-22T14:22:00Z
tags:
  - Entity Framework
  - LINQ
redirect_from: /id/229047/
category: none
layout: post
---
<p><a href="http://blogs.msdn.com/dsimmons/archive/2009/02/21/local-queries.aspx">Danny Simmons posted</a> small helper method for runnning queries against local cache (in ObjectContext). Many of you are probably using similar method. But I don't like to have to specify entity set as a string. That's a first step for refactoring problems. :)</p>

<p>Thus I created little bit different version, using same trick as Matthieu Mezil with <a href="{{ site.url }}{% post_url 2008-07-29-228036-entity-framework-include-with-func %}">Include</a>.</p>
<pre class="brush:csharp">
public static IEnumerable&lt;TEntity&gt; Local&lt;TEntity, TObjectContext&gt;(this ObjectContext context, Expression&lt;Func&lt;TObjectContext, ObjectQuery&lt;TEntity&gt;&gt;&gt; entitySet) where TEntity : class
{
    if (!(entitySet.Body is MemberExpression))
        throw new ArgumentException("entitySet");

    string name = ((MemberExpression)entitySet.Body).Member.Name;
    return context.Local&lt;TEntity&gt;(name);
}
</pre>
<p>It's using Danny's original one to do the dirty work ;), so it's just a small helper for helper. You can call it like <code>e.Local&lt;DETAIL, MyEntities&gt;(x =&gt; x.Details).ToArray();</code> instead of <code>e.Local&lt;DETAIL&gt;("Details").ToArray();</code>.</p>