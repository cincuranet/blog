---
title: "\"Zmenšení\" pole"
date: 2007-10-28T09:21:00Z
tags:
  - .NET
category: none
layout: post
---
<p>Před pár týdny jsem do jednoho projektu potřeboval "zmenšit" pole. Šlo o to, že čísla v poli se posílala poměrně omezeným kanálem (mail+url) a vzhledem k tomu, že to byla IDčka záznamů z DB, která byla plus mínus "za sebou" a rostla s časem chtělo to mít alespoň trochu konstatní velikost výsledku (až budou IDčka v řádu tisíců zbytečně plýtváme). Udělal jsem proto triviální "pack" a "unpack".</p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">// the array SHOULD be sorted< ?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">static</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"> <span style="COLOR: blue">int</span>[] Pack(<span style="COLOR: blue">int</span>[] input)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: green">//we need at least 2 items in array<o :p></o></span></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">if</span> (!(input.Length &gt; 1))<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">throw</span> <span style="COLOR: blue">new</span> <span style="COLOR: #2b91af">ArgumentException</span>();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">int</span>[] result = <span style="COLOR: blue">new</span> <span style="COLOR: blue">int</span>[input.Length];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>result[0] = input[0];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">for</span> (<span style="COLOR: blue">int</span> i = 1; i &lt; input.Length; i++)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">        </span>result[i] = input[i] - input[i - 1];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">return</span> result;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">static</span><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"> <span style="COLOR: blue">int</span>[] Unpack(<span style="COLOR: blue">int</span>[] input)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: green">//we need at least 2 items in array<o :p></o></span></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">if</span> (!(input.Length &gt; 1))<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">        </span><span style="COLOR: blue">throw</span> <span style="COLOR: blue">new</span> <span style="COLOR: #2b91af">ArgumentException</span>();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">int</span>[] result = <span style="COLOR: blue">new</span> <span style="COLOR: blue">int</span>[input.Length];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>result[0] = input[0];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes">   </span><span style="COLOR: blue">for</span> (<span style="COLOR: blue">int</span> i = 1; i &lt; input.Length; i++)<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">        </span>result[i] = result[i - 1] + input[i];<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><o :p> </o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; LINE-HEIGHT: normal; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA"><span style="mso-spacerun: yes">    </span><span style="COLOR: blue">return</span> result;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 10pt"><span style="FONT-SIZE: 10pt; LINE-HEIGHT: 115%; FONT-FAMILY: 'Courier New'; mso-no-proof: yes; mso-ansi-language: CS; mso-bidi-language: AR-SA">}</span></p><p>Pokud jsou ID přibližně za sebou (což jsem já měl) a nejsou tam velké skoky, můžeme tímto poměrně dost znaků ušetřit. </p><p>Pozn.: Nakonec se tento postup stejně nepoužil, takže to byla práce <strike>do šuplíku</strike> na blog. V případě použití doporučuji pořádně otestovat. :)</p><p>Ukázka:<br />Input:<br />1000<br />1001<br />1002<br />1003<br />1010<br /><br />Pack:<br />1000<br />1<br />1<br />1<br />7<br /><br />Unpack:<br />1000<br />1001<br />1002<br />1003<br />1010<br /></p>
