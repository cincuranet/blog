---
title: "New Translate&lt;T&gt; and ExecuteStoreQuery&lt;T&gt; (+ExecuteStoreCommand) on ObjectContext in Entity Framework v4"
date: 2010-04-25T19:20:23Z
tags:
  - .NET
  - Databases in general
  - Entity Framework
redirect_from: /id/231337
category: none
layout: post
---
<p>I don't know whether it's somewhere specifically pointed, but the <a href="http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.aspx">ObjectContext</a> in Entity Framework v4 has two (three) new handy methods. And I like these.</p>

<p>It's kind of escape hatch similar to <a href="http://msdn.microsoft.com/en-us/library/bb738450.aspx">DefiningQuery</a>. First method is <a href="http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.translate.aspx">Translate&lt;T&gt;</a>. It takes DbDataReader and materializes the data back into entities. It's similar to Materialize method from <a href="http://code.msdn.microsoft.com/EFExtensions">EFExtensions</a>. If you some code in pure ADO.NET and you don't have time or resources to redo it in EF (or it's way easier old way) you can rewire the result into existing objects. I like it. Whenever I'll feel I need to get dirty (and probably due to performance reasons) I can do it pretty easily.</p>
<pre class="brush:csharp">using (testovaciEntities ent = new testovaciEntities())
{
	IDbConnection conn = (ent.Connection as EntityConnection).StoreConnection;
	conn.Open();
	using (IDbCommand cmd = conn.CreateCommand())
	{
		cmd.CommandText = "select * from master";
		using (DbDataReader reader = (DbDataReader)cmd.ExecuteReader())
		{
			MASTER[] result = ent.Translate(reader).ToArray();
			Console.WriteLine(result.Length);
		}
	}
}</pre>
<p>The other method is similar and simplifies the process of getting dirty if you simply need to run you fine tuned query with neat and sexy constructs. :) It's <a href="http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.executestorequery.aspx">ExecuteStoreQuery&lt;T&gt;</a>. This method simply allows you to run any sql command directly in store language (thus you can use all features your database offers) and fetch and materialize back resulting entities. Similar to this is <a href="http://msdn.microsoft.com/en-us/library/system.data.objects.objectcontext.executestorecommand.aspx">ExecuteStoreCommand</a> which is similar to ExecuteNonQuery from pure ADO.NET. But you can do this without the method easily too, the method is just more convenient.</p>

<p>BTW also note that the Translate method isn't adding the entities into context, it's just about fetching and materializing.</p>