---
title: "Easier ArgumentException messages"
date: 2012-07-31T14:53:43Z
tags:
  - .NET
  - C#
  - Programming in general
category: devel
layout: post
---
It's a good practice to include parameter name when throwing <a href="http://msdn.microsoft.com/en-us/library/system.argumentexception.aspx">ArgumentException </a> (or similar). But I hate typing the parameter name as string. It's A) boring and B) dumb, because when you refactor the parameter name you have to manually also change this string.

But why not let the language constructs help us? 8-) If we capture the parameter as <i>expression</i> we'll be able to use static typing and extract the name from the expression node.

Shouldn't be that hard, I thought one afternoon, and here's the result (it really isn't).

<pre class="brush:csharp">
static string ArgumentExceptionMessage&lt;T&gt;(Expression&lt;Func&lt;T&gt;&gt; argument)
{
	var me = argument.Body as MemberExpression;
	if (me == null)
		throw new ArgumentException("Cannot extract argument name.", ArgumentExceptionMessage(() =&gt; argument));
	return me.Member.Name;
}
</pre>

And you can use it (normally you would throw exception in all cases, I just wanted to show the result, hence <code>Console.WriteLine</code>).

<pre class="brush:csharp">
class Foo
{
	public int MyProperty { get; set; }
}

static void Main(string[] args)
{
	var f = new Foo();
	Console.WriteLine(ArgumentExceptionMessage(() =&gt; args));
	Console.WriteLine(ArgumentExceptionMessage(() =&gt; f.MyProperty));

	throw new ArgumentException("This argument is not correct.", ArgumentExceptionMessage(() =&gt; args));
}
</pre>

There's never enough precondition checks. And understandable messages/parameters of exceptions is a valued help for developers. You can even wrap it to method returning <code>ArgumentException</code> directly to have more succinct code.
