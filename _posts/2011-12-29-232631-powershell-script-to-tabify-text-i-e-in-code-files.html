---
title: "PowerShell script to tabify text (i.e. in code files)"
date: 2011-12-29T18:50:23Z
tags:
  - C#
  - PowerShell
redirect_from: /id/232631
category: none
layout: post
---
<p>Few weeks ago I needed to tabify (change spaces to tabs) in a C# files in a solution. I tested some plug-ins to Visual Studio, but none of them did what I wanted. I left the idea, as it was not that important to have consistent tabs/spaces. But a day or two ago I had some time and yen for to create simple <a href="http://technet.microsoft.com/en-us/library/bb978526.aspx">PowerShell</a> script to fix that for me. It simply replaces <i>x</i> <code>spaces</code> taken from input parameter with tab(s). Text goes to <code>stdin</code> and result to <code>stdout</code>.</p>

<pre class="brush:powershell">
param([int]$spaces)

$pattern = '';
for ($i = 0; $i -lt $spaces; $i++) {
	$pattern = $pattern + ' ';
}
$pattern = '^((' + $pattern + ')*)' + $pattern;
$replace = '$1' + "`t";

$input | foreach {
	$text = $_;
	do {
		$prev = $text;
		$text = $text -replace $pattern, $replace;
	} while ($prev -ne $text)
	Write-Output $text;
}
</pre>

<p>The script, as you can see, is not interpreting the code in any way, hence some spaces i.e. in comments at the beginning might become tabs even if that's actually wrong. But hey, you can take <a href="http://msdn.com/roslyn">Roslyn</a> and plug it in, as an exercise. :)</p>

<p>To, for instance, tabify all <code>.cs</code> files in some path, you can call this script (saved as <code>tabify.ps1</code>) using something like:</p>
<pre class="brush:powershell">
Get-ChildItem -Recurse ".\src" | Where-Object {$_.Extension -eq ".cs"} | foreach { Get-Content $_.FullName | .\tabify.ps1 -Spaces 2 | Set-Content -Encoding UTF8 ($_.FullName + ".tabs") }
</pre>