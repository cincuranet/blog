---
title: "POCOs and Entity Framework's automagic association wiring"
date: 2010-04-10T19:37:20Z
tags:
  - Entity Framework
category: none
layout: post
---
<p>Entity Framework has a nice ability to wire up associations on both ends when the related entities come into context. This feature is handy and you can use it to simulate some scenarios, like <a href="{% post_url 2009-04-22-229660-load-with-filtering-or-limiting %}">this</a>. But we're on EFv4 time, everybody is using POCO. ;)</p> 

<p>In last project I used POCO too, just to make myself more familiar with the way how it works in EFv4 and to face some challenges. Last week I was designing some flow, and I needed to have some related objects in memory too. I immediately jumped into <a href="http://msdn.microsoft.com/en-us/library/bb738708.aspx">Include method</a> (actually I used <a href="{% post_url 2008-07-29-228036-entity-framework-include-with-func %}">this</a> improved version). But later I couldn't help but wonder would the automagic association wiring with (pure) POCOs?</p>

<p>I created simple <code>master-detail</code> scenario and created these POCO classes (note I'm not going to use proxies).</p>

<pre class="brush:csharp">
class Master
{
	public int ID { get; set; }
	public string Foo { get; set; }
	public ICollection&lt;Detail&gt; Details { get; set; }

	public Master()
	{
		this.Details = new List&lt;Detail&gt;();
	}
}

class Detail
{
	public int ID { get; set; }
	public string Bar { get; set; }
	public Master Master { get; set; }
}
</pre>

<p>And created test code (<code>testEntities</code> is a simple ObjectContext).</p>

<pre class="brush:csharp">
using (testEntities ent = new testEntities())
{
	ent.ContextOptions.LazyLoadingEnabled = false;

	var details = ent.Details.ToArray();
	var q = ent.Masters;
	foreach (var item in q)
	{
		Console.WriteLine(item.Details.Count);
	}
	foreach(var item in details)
	{
		Console.WriteLine(item.Master.ID);
	}
}
</pre>

<p>If you run the code, you'll see it works as expected. Exactly like the generated classes, although these are (pure) POCO classes - no need to use proxies or any special collections. I like the smart work done behind by Entity Framework for me.</p>
