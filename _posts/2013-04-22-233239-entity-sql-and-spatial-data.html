---
title: "Entity SQL and spatial data"
date: 2013-04-22T18:25:21Z
tags:
  - Entity Framework
  - Entity SQL
  - LINQ
  - Spatial data
category: devel
layout: post
---
<p>When the <a href="http://msdn.com/ef">Entity Framework</a> was first introduced it came with (basically) two flavors of querying. <a href="http://msdn.microsoft.com/en-us/library/bb386964.aspx">LINQ to Entities</a> and <a href="http://msdn.microsoft.com/en-us/library/bb399560.aspx">Entity SQL</a> (ESQL). I'm not going to describe the history here. But as LINQ (any LINQ) gained popularity it was obvious, that LINQ to Entities is a future (though it had initially small deficit compared to Entity SQL). I even on <a href="http://www.x2develop.com">my courses</a> recommend using LINQ to Entities whenever possible and I'm also showing some dynamic querying where normally people start concatenating ESQL strings.</p>

<p>Recently Entity Framework added support for spatial data (and enums, ...). All examples I've ever seen around spatial data and Entity Framework were using LINQ (obviously). Only few weeks ago I realized how the querying should work with Entity SQL. As it turned out spatial data are not first class citizen in Entity SQL world. There's no <a href="http://msdn.microsoft.com/en-us/library/bb399176.aspx">literal</a> for i.e. point. But canonical functions are here to save you. There's a <a href="http://msdn.microsoft.com/en-us/library/hh749531.aspx">bunch of these spatial data related</a>. What we're looking for though is <code>GeometryFromText</code>/<code>GeographyFromText</code>. With these you can <a href="http://msdn.microsoft.com/en-us/library/dn133443.aspx">construct</a> <code>Geometry</code>/<code>Geography</code> datatype from <a href="http://en.wikipedia.org/wiki/Well-known_text">well-known text (WKT)</a> and use it in query.</p> 

<p>I've never used Entity SQL query in any real-world application I created. I'm too afraid of typos etc. But I did a lot of magic with expression trees. :) Wondering what percentage of people using Entity Framework is using Entity SQL and whether there are some scenarios that are crazy hard in LINQ...</p>

