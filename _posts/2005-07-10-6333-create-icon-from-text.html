---
title: "Create icon from text"
date: 2005-07-10T14:18:00Z
tags:
  - .NET
category: devel
layout: post
---
<p>Here's easy function for creating icon from string. I'm using it for traybar icon and for showing some usefull information on my notebook, i.e. the battery life in minutes.</p><p><hr id=null/></p><p></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><span style="mso-spacerun: yes">          </span>private static </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">System</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Drawing</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Icon DrawIcon</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">string </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">IconMessage</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">)< ?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 1">      </span><span style="mso-spacerun: yes">    </span>{</span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Icon result </span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">= </span><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">null</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span></span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">try<o :p></o></span></b></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span></span></b><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">              </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Bitmap b </span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">= </span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">new </span></b><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Bitmap</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: darkblue; FONT-FAMILY: 'Courier New'">16</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">,</span><span style="FONT-SIZE: 10pt; COLOR: darkblue; FONT-FAMILY: 'Courier New'">16</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">  </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Graphics g </span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">= </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Graphics</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">FromImage</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">((</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Image</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">)</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">b</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">); <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">  </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">g</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">DrawString</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">IconMessage</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">,<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">               </span></span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">new </span></b><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Font</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">"Arial"</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">, </span><span style="FONT-SIZE: 10pt; COLOR: darkblue; FONT-FAMILY: 'Courier New'">10</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">, </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">FontStyle</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Regular</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">, </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">GraphicsUnit</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Pixel</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">),<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">               </span></span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">new </span></b><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">SolidBrush</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">System</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Drawing</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Color</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Black</span><span style="FONT-SIZE:
 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">),<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">               </span></span><span style="FONT-SIZE: 10pt; COLOR: darkblue; FONT-FAMILY: 'Courier New'">0</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">,</span><span style="FONT-SIZE: 10pt; COLOR: darkblue; FONT-FAMILY: 'Courier New'">1</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">  </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">result </span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">= </span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Icon</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">FromHandle</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">b</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">GetHicon</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">()); <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">  </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">g</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Dispose</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 2">            </span><span style="mso-spacerun: yes">  </span></span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">b</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">.</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Dispose</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">();<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span></span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">catch </span></b><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">(</span><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">Exception e</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">) <o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span>{<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">              //</span>Console.WriteLine(e.Message);<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span>}<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt; mso-layout-grid-align: none"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 3">            </span></span><b><span style="FONT-SIZE: 10pt; COLOR: blue; FONT-FAMILY: 'Courier New'">return </span></b><span style="FONT-SIZE: 10pt; COLOR: black; FONT-FAMILY: 'Courier New'">result</span><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'">;<o :p></o></span></p><p class=MsoNormal style="MARGIN: 0cm 0cm 0pt"><span style="FONT-SIZE: 10pt; COLOR: green; FONT-FAMILY: 'Courier New'"><span style="mso-tab-count: 1">      </span><span style="mso-spacerun: yes">    </span>}</span></p>
