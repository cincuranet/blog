---
title: "LINQ and left outer join helper"
date: 2010-10-05T09:55:38Z
tags:
  - .NET
  - C#
  - LINQ
redirect_from: /id/232037/
category: none
layout: post
---
<p>Previous two functions (<a href="{{ site.url }}{% post_url 2010-10-05-232039-interleaving-two-ienumerable-sources %}">function 1</a>, <a href="{{ site.url }}{% post_url 2010-10-05-232041-aggregating-with-increments %}">function 2</a>) I presented were doing something that wasn't core part of <a href="http://en.wikipedia.org/wiki/Language_Integrated_Query">LINQ</a> and it was up to you to create it. On the other hand, this function is different. It's just a helper to simplify writing of <a href="http://en.wikipedia.org/wiki/Join_(SQL)#Left_outer_join">left outer join</a> (or right outer join, depending on what collection you consider to be on left/right side). Not because it's hard to write it, but because it involves couple of lines and repeating it all the time is just boring. 8-)</p>

<pre class="brush:csharp">
internal static IEnumerable&lt;TResult&gt; LeftOuterJoin&lt;TOuter, TLeft, TKey, TResult&gt;(this IEnumerable&lt;TOuter&gt; outer, IEnumerable&lt;TLeft&gt; left, Func&lt;TOuter, TKey&gt; outerKeySelector, Func&lt;TLeft, TKey&gt; leftKeySelector, Func&lt;TOuter, TLeft, TResult&gt; resultSelector)
{
	return
		from o in outer
		join r in left on outerKeySelector(o) equals leftKeySelector(r) into j
		from r in j.DefaultIfEmpty()
		select resultSelector(o, r);
}
</pre>

<p>Nothing tricky. You can find this in many examples, I just wrapped it into method and parametrized it a little. Enjoy.</p>